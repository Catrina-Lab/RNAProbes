FROM python:3.9-slim


WORKDIR /app

COPY pyproject.toml poetry.lock ./
RUN pip install poetry \
    && poetry config virtualenvs.in-project true

COPY src/ .

RUN ls
RUN poetry install --project rnaprobes

RUN find rnaprobes/RNAStructure_Binaries/Linux64 -type f -exec chmod +x {} \;
CMD ["timeout", "10s", "poetry", "run", "--project", "rnaprobes", "python", "-m", "rnaprobes", "SKIP_RUN"]
