{% extends 'base.html' %}

{% block head_content %}
  <style>
    .program-card {
      cursor: pointer;
      border: 2px solid transparent;
      transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      height: 100%;
    }
    .program-card:has(input[type="checkbox"]:checked) {
      border-color: #0d6efd;
      box-shadow: 0 0 10px rgba(13, 110, 253, 0.5);
    }
    .program-card .form-check-input {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .warning-text {
      color: #ea1212 !important;
      font-weight: bold;
    }
  </style>
{% endblock %}

{% block content %}
  <div class="container">
    <h1 class="text-center mb-4">Welcome to the RNA Tool Suite</h1>
    <p class="text-center text-muted" id="program-select-label">Select one or more programs to begin.</p>
    <form action="/form" method="post" id="program-form">
      <div class="row">
        <div class="col-md-4">
          <div class="card text-center program-card" data-program="sm-fish">
            <div class="card-body">
              <h5 class="card-title">smFISH</h5>
              <p class="card-text">Single-molecule fluorescence in situ hybridization (smFISH) probe design, considering secondary strucutures.</p>
              <input type="checkbox" name="programs" value="smFISH" class="form-check-input d-none">
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card text-center program-card" data-program="tfofinder">
            <div class="card-body">
              <h5 class="card-title">TFOFinder</h5>
              <p class="card-text">Triplex-forming oligonucleotide (TFO) target designer for RNA.</p>
              <input type="checkbox" name="programs" value="TFOFinder" class="form-check-input d-none">
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card text-center program-card" data-program="pinmol">
            <div class="card-body">
              <h5 class="card-title">PinMol</h5>
              <p class="card-text">Molecular beacons designer for live cell imaging of mRNA targets.</p>
              <input type="checkbox" name="programs" value="PinMol" class="form-check-input d-none">
            </div>
          </div>
        </div>
      </div>
      <div class="text-center mt-4">
          <button type="submit" class="btn btn-primary btn-lg">Proceed</button>
      </div>
    </form>
  </div>

{% endblock %}

{% block scripts %}
  <script id="functions">
    function makeRed(id, remove = false){
      if(remove) document.getElementById(id).classList.remove("warning-text");
      else document.getElementById(id).classList.add("warning-text");
    }

    function clickCard(programCard){
      const checkbox = programCard.querySelector('input[type="checkbox"]'); //click the invisible checkbox
      checkbox.checked = !checkbox.checked;
      if(checkbox.checked) makeRed('program-select-label', true); //make it not red
    }
  </script>
  <script>
    const form = document.querySelector('#program-form');
    form.addEventListener('click', e => {
      let clickedElement;
      if(clickedElement = e.target.closest(".program-card")){ //if you clicked a program-card (works with dynamic elements)
        clickCard(clickedElement);
      }
    });
    form.addEventListener('submit', e=>{
      data = new FormData(form)
      if(!data.get('programs')){
        e.preventDefault();
        makeRed('program-select-label');
      }
    });
  </script>
{% endblock %}