{% extends 'base.html' %}

{% block content %}
  <div class="hero-section">
    <h1 class="display-4">RNA Tools</h1>
    <p class="lead">A collection of powerful tools for RNA analysis and design.</p>
  </div>

  <p class="text-center text-muted mb-4" id="program-select-label">Select one or more programs to begin.</p>

  <form action="/form" method="post" id="program-form">
    <div class="row">
      <div class="col-md-4 mb-4">
        <div class="card program-card" data-program="smFISH">
          <div class="card-icon"><i class="fas fa-search-plus"></i></div>
          <h5 class="card-title">smFISH</h5>
          <p class="card-text">Probe design for single-molecule fluorescence in situ hybridization (smFISH), considering secondary structures.</p>
          <input type="checkbox" name="programs" value="smFISH" class="form-check-input">
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card program-card" data-program="TFOFinder">
          <div class="card-icon"><i class="fas fa-bullseye"></i></div>
          <h5 class="card-title">TFOFinder</h5>
          <p class="card-text">Target designer for triplex-forming oligonucleotides (TFOs) in RNA.</p>
          <input type="checkbox" name="programs" value="TFOFinder" class="form-check-input">
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card program-card" data-program="PinMol">
          <div class="card-icon"><i class="fas fa-map-pin"></i></div>
          <h5 class="card-title">PinMol</h5>
          <p class="card-text">Molecular beacon designer for live-cell imaging of mRNA targets.</p>
          <input type="checkbox" name="programs" value="PinMol" class="form-check-input">
        </div>
      </div>
    </div>
    <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary btn-lg proceed-btn">Proceed</button>
    </div>
  </form>
{% endblock %}

{% block scripts %}
<script id="functions">
    function changeWarningText(id, remove = false){
      if(remove) document.getElementById(id).classList.remove("warning-text");
      else document.getElementById(id).classList.add("warning-text");
    }

    function clickCard(programCard){
      const checkbox = programCard.querySelector('input[type="checkbox"]'); //click the invisible checkbox
      checkbox.checked = !checkbox.checked;
      if(checkbox.checked) changeWarningText('program-select-label', true); //make it not red
    }
  </script>
  
  <script>
    const form = document.querySelector('#program-form');
    form.addEventListener('click', e => {
      let clickedElement;
      if(clickedElement = e.target.closest(".program-card")){ //if you clicked a program-card (works with dynamic elements)
        clickCard(clickedElement);
      }
    });
    form.addEventListener('submit', e=>{
      const selectedPrograms = form.querySelectorAll('input[type="checkbox"][name="programs"]:checked');
      if(selectedPrograms.length === 0){
        e.preventDefault();
        changeWarningText('program-select-label');
      }
    });
  </script>
{% endblock %}